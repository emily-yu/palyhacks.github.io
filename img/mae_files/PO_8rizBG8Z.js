if (self.CavalryLogger) { CavalryLogger.start_js(["iyM1N"]); }

__d('Dcode',[],(function a(b,c,d,e,f,g){var h,i={},j={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var l=[];for(var m in j){i[j[m]]=m;l.push(j[m]);}l.reverse();h=new RegExp(l.join("|"),'g');})();var k={encode:function l(m){return encodeURIComponent(m).replace(/([_A-Z])|%../g,function(n,o){return o?'%'+o.charCodeAt(0).toString(16):n;}).toLowerCase().replace(h,function(n){return i[n];});},decode:function l(m){return decodeURIComponent(m.replace(/[_A-Z]/g,function(n){return j[n];}));}};f.exports=k;}),null);
__d('PresenceCookieManager',['Cookie','CurrentUser','Dcode','ErrorUtils','JSLogger','PresenceInitialData','PresenceUtil','URI'],(function a(b,c,d,e,f,g){var h=c('PresenceInitialData').cookieVersion,i='presence',j={},k=null,l=null,m=c('JSLogger').create('presence_cookie');function n(){try{var r=c('Cookie').get(i);if(k!==r){k=r;l=null;if(r&&r.charAt(0)=='E')r=c('Dcode').decode(r.substring(1));if(r)l=JSON.parse(r);}if(l){if(l.user&&l.user!==c('CurrentUser').getID())return null;if(l.v!==h)return null;return l;}}catch(q){m.warn('getcookie_error',q);}return null;}function o(){return parseInt(Date.now()/1000,10);}var p={register:function q(r,s){j[r]=s;},store:function q(){var r=n();if(r&&r.v&&h<r.v){m.debug('stale_cookie',h);return;}var s={v:h,time:o(),user:c('CurrentUser').getID()};for(var t in j)s[t]=c('ErrorUtils').applyWithGuard(j[t],j,[r&&r[t]],function(x){x.presence_subcookie=t;});var u='E'+c('Dcode').encode(JSON.stringify(s));if(c('PresenceUtil').hasUserCookie()){var v=u.length;if(v>1024)m.warn('big_cookie',v);var w=c('URI').getRequestURI(false).isSecure()&&!!c('Cookie').get('csm');c('Cookie').set(i,u,null,null,w);}},clear:function q(){c('Cookie').clear(i);},getSubCookie:function q(r){var s=n();if(!s)return null;return s[r];}};f.exports=p;}),null);
__d('PresenceState',['Arbiter','ErrorUtils','JSLogger','PresenceCookieManager','debounceAcrossTransitions','setIntervalAcrossTransitions','PresenceInitialData'],(function a(b,c,d,e,f,g){var h=c('PresenceInitialData').cookiePollInterval||2000,i=c('PresenceInitialData').shouldSuppress||false,j=[],k=[],l=null,m=null,n=0,o=null,p=0,q=['sb2','t2','lm2','uct2','tr','tw','at','wml'],r=c('JSLogger').create('presence_state');function s(){return c('PresenceCookieManager').getSubCookie('state');}function t(){n=Date.now();c('PresenceCookieManager').store();x(m);}var u=c('debounceAcrossTransitions')(t,0);function v(ca){if(typeof ca=='undefined'||isNaN(ca)||ca==Number.POSITIVE_INFINITY||ca==Number.NEGATIVE_INFINITY)ca=0;return ca;}function w(ca){var da={};if(ca){q.forEach(function(ga){da[ga]=ca[ga];});if(n<ca.ut)r.error('new_cookie',{cookie_time:ca.ut,local_time:n});}da.ut=n;for(var ea=0,fa=j.length;ea<fa;ea++)c('ErrorUtils').applyWithGuard(j[ea],null,[da]);m=da;return m;}function x(ca){p++;n=v(ca.ut);if(!l)l=c('setIntervalAcrossTransitions')(aa,h);m=ca;if(o===null)o=ca;for(var da=0,ea=k.length;da<ea;da++)c('ErrorUtils').applyWithGuard(k[da],null,[ca]);p--;}function y(ca){if(ca&&ca.ut)if(n<ca.ut){return true;}else if(ca.ut<n)r.error('old_cookie',{cookie_time:ca.ut,local_time:n});return false;}function z(){var ca=s();if(y(ca))m=ca;return m;}function aa(){var ca=s();if(y(ca))x(ca);}c('PresenceCookieManager').register('state',w);c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ca,da){da.presence_state={initial:babelHelpers['extends']({},o),state:babelHelpers['extends']({},m),update_time:n,sync_paused:p,poll_time:h};});(function(){var ca=z();if(ca){x(ca);}else{r.debug('no_cookie_initial');x(w());return;}})();var ba={doSync:function ca(da){if(p)return;if(da){t();}else u();},registerStateStorer:function ca(da){j.push(da);},registerStateLoader:function ca(da){k.push(da);},get:function ca(){return z();},getInitial:function ca(){return o;},shouldSuppress:function ca(){return i;},verifyNumber:v};f.exports=ba;}),null);
__d('StickerContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','MercuryConfig','ReactAbstractContextualDialog','ReactLayer'],(function a(b,c,d,e,f,g,h){'use strict';var i=7,j=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:i,length:16}}}));j.WIDTH={NORMAL:312,WIDE:400};f.exports=j;}),null);
__d('StickersDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('ExplicitRegistrationDispatcher'))({strict:false});}),null);
__d('StickersActions',['StickersDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ADD_RECENT_STICKER:null,HIDE_FLYOUT:null,LOAD_RECENT_STICKERS:null,SELECT_STORE_PACK:null,SELECT_TRAY_PACK:null,SHOW_FLYOUT:null,TRAY_LOADED:null}),i={Types:h,addRecentSticker:function j(k){c('StickersDispatcher').dispatch({type:h.ADD_RECENT_STICKER,sticker:k});},hideStickerFlyout:function j(){c('StickersDispatcher').dispatch({type:h.HIDE_FLYOUT});},loadRecentStickers:function j(k){c('StickersDispatcher').dispatch({type:h.LOAD_RECENT_STICKERS,stickers:k});},selectStorePack:function j(k){c('StickersDispatcher').dispatch({type:h.SELECT_STORE_PACK,packID:k});},selectTrayPack:function j(k){c('StickersDispatcher').dispatch({type:h.SELECT_TRAY_PACK,packID:k});},showStickerFlyout:function j(k){c('StickersDispatcher').dispatch({type:h.SHOW_FLYOUT,threadID:k});},trayLoaded:function j(){c('StickersDispatcher').dispatch({type:h.TRAY_LOADED});}};f.exports=i;}),null);
__d('StickersStateStore',['FluxReduceStore','immutable','PresenceState','StickersActions','StickersConfig','StickersDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){var k=c('PresenceState').get();return new (c('immutable').Map)({recentStickers:[],recentStickersLoaded:false,showFlyout:false,storePackID:null,threadID:null,trayLoaded:false,trayPackID:k?k.tray_pack_id:null});};j.prototype.reduce=function(k,l){var m=l,n=c('StickersActions').Types;switch(m.type){case n.ADD_RECENT_STICKER:var o=[m.sticker];k.get('recentStickers').forEach(function(p){if(p.id===m.sticker.id)return;o.push(p);});return k.set('recentStickers',o.splice(0,c('StickersConfig').max_mru_stickers));case n.HIDE_FLYOUT:return k.set('showFlyout',false);case n.LOAD_RECENT_STICKERS:return k.set('recentStickersLoaded',true).set('recentStickers',m.stickers);case n.SELECT_STORE_PACK:return k.set('storePackID',m.packID);case n.SELECT_TRAY_PACK:return k.set('trayPackID',m.packID).set('trayLoaded',true);case n.SHOW_FLYOUT:return k.set('showFlyout',true).set('threadID',m.threadID);case n.TRAY_LOADED:return k.set('trayLoaded',true);default:return k;}};function j(){h.apply(this,arguments);}f.exports=new j(c('StickersDispatcher'));}),null);
__d('ChatStickerButton.react',['cx','fbt','BootloadedComponent.react','JSResource','Link.react','React','StickerContextualDialog.react','StickersActions','StickersStateStore','TimeSliceInteraction','XUISpinner.react','emptyFunction','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m=278;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;function n(o){k.constructor.call(this,o);this.$ChatStickerButton1=false;this.renderLayers=function(){if(!this.state.shown)return null;var p=this.props.ContextualDialogClass;return (c('React').createElement(p,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBeforeHide:this.$ChatStickerButton5,onBlur:this.$ChatStickerButton3,position:'above',shown:this.state.shown,width:this.props.flyoutWidth,key:'contextualDialog'},c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{padding:'30px',textAlign:'center'}},c('React').createElement(c('XUISpinner.react'),{size:'large'})),bootloadLoader:c('JSResource')('StickersFlyout.react').__setRef('ChatStickerButton.react'),className:this.props.flyoutClassName,onShown:function(q){if(this.props.onFlyoutShown)this.props.onFlyoutShown(q);}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this.$ChatStickerButton3,onStickerSelect:this.$ChatStickerButton6,onEmoticonSelect:this.$ChatStickerButton7,shown:this.state.shown})));}.bind(this);this.$ChatStickerButton4=function(){this.$ChatStickerButton1=this.state.shown;}.bind(this);this.showFlyout=function(p){p&&p.stopPropagation();if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return;}c('TimeSliceInteraction').createAutoclosed('chat_sticker_flyout_show');c('StickersActions').showStickerFlyout(this.props.threadID);}.bind(this);this.$ChatStickerButton5=function(){if(this.state.shown)this.$ChatStickerButton3();}.bind(this);this.$ChatStickerButton3=function(){c('StickersActions').hideStickerFlyout();};this.$ChatStickerButton6=function(p){this.props.onStickerSelect(p);}.bind(this);this.$ChatStickerButton7=function(p){this.$ChatStickerButton3();this.props.onEmoticonSelect(p);}.bind(this);this.state={shown:!!o.clicked};}n.prototype.componentDidMount=function(){this.props.onLoad&&this.props.onLoad(this);this.$ChatStickerButton2=c('StickersStateStore').addListener(function(){var o=c('StickersStateStore').getState();if(o.get('showFlyout')&&o.get('threadID')===this.props.threadID){if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return;}this.setState({shown:true});}else{var p=this.props.getInput&&this.props.getInput();p&&p.focus&&p.focus();this.setState({shown:false});}}.bind(this));};n.prototype.componentWillUnmount=function(){if(this.state.shown)this.$ChatStickerButton3();this.$ChatStickerButton2&&this.$ChatStickerButton2.remove();};n.prototype.render=function(){return c('React').createElement('span',null,c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onClick:this.showFlyout,onMouseDown:this.$ChatStickerButton4,role:'button',title:i._("Choose a sticker"),ref:'link'}),this.renderLayers());};n.propTypes={className:l.string,clicked:l.bool,ContextualDialogClass:l.func.isRequired,disabled:l.bool,flyoutClassName:l.string,flyoutWidth:l.number,getInput:l.func,onLoad:l.func,onStickerSelect:l.func.isRequired,onEmoticonSelect:l.func.isRequired,onFlyoutShown:l.func,onFlyoutHidden:l.func,threadID:l.string};n.defaultProps={clicked:false,ContextualDialogClass:c('StickerContextualDialog.react'),disabled:false,flyoutWidth:m,onStickerSelect:c('emptyFunction'),onEmoticonSelect:c('emptyFunction')};f.exports=n;}),null);